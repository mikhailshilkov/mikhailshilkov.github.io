<!DOCTYPE html>
<html lang="en-us" prefix="og: http://ogp.me/ns#"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<link rel="icon" type="image/png" href="/favicon.ico">
	
	
	<title>Inputs and Outputs | Mikhail Shilkov</title>
	
	
	
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
	
	<link rel="stylesheet" href="/sass/main.css">

	
	
	<meta property="og:title" content="Inputs and Outputs" />
	<meta property="og:description" content="We created a working Terraform module, but it has several essential properties hard-coded in the text. This fact limits its reusability: for example, you wouldn&rsquo;t be able to use the same module to deploy to multiple environments like production and staging. Environments would clash on the name of the Function App. Also, if you choose to deploy to another Azure region, you have to change the code." />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://mikhail.io/lab/terraform/9-inouts/" />

	
	
	
	


	
	

	
	
	<meta name="twitter:card" content="summary"/>
	
	

	<meta name="twitter:title" content="Inputs and Outputs"/>
	<meta name="twitter:description" content="We created a working Terraform module, but it has several essential properties hard-coded in the text. This fact limits its reusability: for example, you wouldn&rsquo;t be able to use the same module to deploy to multiple environments like production and staging. Environments would clash on the name of the Function App. Also, if you choose to deploy to another Azure region, you have to change the code."/>
	<meta name="twitter:creator" content="@MikhailShilkov"></meta>
</head>
<body><script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load("current", {packages:["corechart"]});
    function addChart(make) {
        google.charts.setOnLoadCallback(drawChart);
        function drawChart() {
            const data = new google.visualization.DataTable();

            const options = {
                height: 420,  
                chartArea: { width: '85%', height: '70%' },
                legend: 'none',
                hAxis: { minValue: 0 },
                vAxis: {},
                series: {      
                    0: { tooltip : false}
                }
            };
            const chart = make(data, options);
            options.hAxis.textStyle = options.hAxis.titleTextStyle 
                = options.vAxis.textStyle = options.vAxis.titleTextStyle = { fontName: 'Merriweather' };

            chart.draw(data, options);
        }
    }
</script>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container pr-0">
        <a class="navbar-brand" href="/">
            <img class="author-thumb" src="/images/author.jpg" alt="Mikhail Shilkov">
            <span class="text-primary">Mikhail Shilkov</span>
        </a>

        
               


        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">TOPICS</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/archives/">ARCHIVES</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/talks/">TALKS</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">ABOUT</a>
                </li>
                <li class="nav-item">
    <a class="nav-link" href="https://mikhail.io/feed/"><i class="fas fa-rss social-icon" aria-hidden="true"></i></a>
</li>

<li class="nav-item">
    <a class="nav-link" href="https://x.com/MikhailShilkov"><i class="fab fa-twitter social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://dev.to/mikhailshilkov"><i class="fab fa-dev social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://medium.com/@MikhailShilkov"><i class="fab fa-medium social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://github.com/MikhailShilkov"><i class="fab fa-github social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/MikhailShilkov"><i class="fab fa-linkedin social-icon" aria-hidden="true"></i></a>
</li>

</ul>
        </div>
        
    </div>
</nav>


        <div class="container">

<div class="main-content">
    
    <div class="container">
        <div class="row">
            
            <div class="col-lg-3 pl-0">
                <nav class="sidebar">
                    <div class="sidebar-header">
                        <h3>Learn Terraform</h3>
                    </div>

                    <ul class="list-unstyled components">
                        <p>to deploy Azure Functions and co.</p>
                        <li>
                            <a href="..">Introduction</a>
                        </li>
                        
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/1-prerequisites/">1. Prerequisites</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/2-newfile/">2. New Terraform File</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/3-resourcegroup/">3. Resource Group</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/4-storageaccount/">4. Storage Account</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/5-expressions/">5. Expressions</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/6-state/">6. Terraform State</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/7-consumptionplan/">7. Consumption Plan</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/8-functionapp/">8. Function App</a>
                            
                        </li>
                        
                        <li>
                            
                            <span class="current">9. Inputs and Outputs</span>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/10-multiplefiles/">10. Multiple Files</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/11-furthersteps/">11. Further Steps</a>
                            
                        </li>
                        
                        <li>
                            
                            <a href="https://mikhail.io/lab/terraform/12-cleanup/">12. Clean Up</a>
                            
                        </li>
                        
                    </ul>
                </nav>
            </div>
            
            <div class="col-lg-8 offset-lg-1 flex-first flex-lg-unordered">

                <div class="mainheading">
                    
                    <h1 class="posttitle">Inputs and Outputs</h1>
                    
                    <div class="post-top-meta">
                        <div>
                            <span class="post-date"> 6 minutes to complete</span>
                        </div>
                    </div>
                </div>

                
                <div class="article-post">
                    <p>We created a working Terraform module, but it has several essential properties hard-coded in the text. This fact limits its reusability: for example, you wouldn&rsquo;t be able to use the same module to deploy to multiple environments like production and staging. Environments would clash on the name of the Function App. Also, if you choose to deploy to another Azure region, you have to change the code.</p>
<p>Let&rsquo;s learn how to parameterize your Terraform modules.</p>
<h2 id="input-variables">Input variables</h2>
<p>Input variables serve as parameters for a Terraform module, allowing aspects of the module to be customized without altering the module&rsquo;s source code.</p>
<p>Each input variable accepted by a module must be declared using a <code>variable</code> block. Extend your module with a definition of the <code>region</code> variable:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#00f">variable</span> <span style="color:#a31515">&#34;region&#34;</span> {
</span></span><span style="display:flex;"><span>  type    = <span style="color:#00f">string</span>
</span></span><span style="display:flex;"><span>  default = <span style="color:#a31515">&#34;westus&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, you can refer to the variable value with <code>var.&lt;NAME&gt;</code> expression. Change the definition of your Resource Group to set the region from the variable:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#00f">resource</span> <span style="color:#a31515">&#34;azurerm_resource_group&#34; &#34;rg&#34;</span> {
</span></span><span style="display:flex;"><span>  name     = <span style="color:#a31515">&#34;terraform-workshop&#34;</span>
</span></span><span style="display:flex;"><span>  location = <span style="color:#00f">var</span>.<span style="color:#00f">region</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Our <code>region</code> variable has a default value. If you want to override this value, you can pass a <code>-var</code> parameter to the CLI call:</p>
<pre tabindex="0"><code>terraform apply -var=&#34;region=westeurope&#34;
</code></pre><p>The <code>-var</code> option can be used any number of times in a single command, e.g. <code>terraform apply -var=&quot;a=b&quot; -var=&quot;c=d&quot;</code>.</p>
<p>Go ahead and define variables <code>rg_name</code> for the Resource Group name and <code>app_name</code> for the Function App name. Use those variables in resource definitions. Construct the name of the App Service Plan to be <code>${var.app_name}-asp</code>.</p>
<p>Apply the changes: some resources will likely need to be replaced.</p>
<h2 id="output-values">Output values</h2>
<p>It&rsquo;s also possible to return values from a Terraform module. Let&rsquo;s define an <em>output value</em> to return the endpoint of our Azure Function. Add the following block to your <code>main.tf</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-hcl" data-lang="hcl"><span style="display:flex;"><span><span style="color:#00f">output</span> <span style="color:#a31515">&#34;endpoint&#34;</span> {
</span></span><span style="display:flex;"><span>  value = <span style="color:#a31515">&#34;https://${azurerm_function_app.app.default_hostname}/api/hello&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>terraform apply</code> command automatically prints the output values:</p>
<pre tabindex="0"><code>Apply complete! Resources: 0 added, 0 changed, 0 destroyed.

Outputs:

endpoint = https://myuniquename.azurewebsites.net/api/hello
</code></pre><h2 id="checkpoint">Checkpoint</h2>
<p>Send an HTTP request to the endpoint above via a browser, or with a <code>curl</code> command, and make sure it still returns a greeting.</p>


                    
                    <p>If you have any difficulties, compare your code with <a href="main.tf" target="blank">this
                            sample</a>.</p>
                    

                    
                    
                    <h2>Next Step</h2>
                    <a href="https://mikhail.io/lab/terraform/10-multiplefiles/">
                        <button type="button" class="btn btn-primary btn-lg">
                            
                            Structure a Module as Multiple Files
                            
                        </button>
                    </a>
                    
                    
                </div>

                
                <div class="after-post-tags">
                    <ul class="tags">
                        
                    </ul>
                </div>
                

            </div>
            
        </div>
    </div>
    
    
</div>

        </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright Mikhail Shilkov - All rights reserved
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                
            </div>
        </div>
    </div>
</footer>











<script src="/js/bundle.min.js"></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-NL7F82LX48"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NL7F82LX48');
        }
      </script>
    </body>
</html>
