<!DOCTYPE html>
<html lang="en-us" prefix="og: http://ogp.me/ns#"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<link rel="icon" type="image/png" href="/favicon.ico">
	
	
	<title>A Practical Approach to Temporal Architecture | Mikhail Shilkov</title>
	
	
	
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
	
	<link rel="stylesheet" href="/sass/main.css">

	
	
	<meta property="og:title" content="A Practical Approach to Temporal Architecture" />
	<meta property="og:description" content="What it takes to get Temporal workflows up and running" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://mikhail.io/2020/10/practical-approach-to-temporal-architecture/" />

	
	
	
	
	<meta property="og:image" content="https://mikhail.io/2020/10/practical-approach-to-temporal-architecture/teaser.png" />
	
	


	
	
	<meta property="article:tag" content="Temporal" />
	

	
	
	<meta name="twitter:card" content="summary_large_image"/>
	
	<meta name="twitter:image" content="https://mikhail.io/2020/10/practical-approach-to-temporal-architecture/teaser.png" />
	
	

	<meta name="twitter:title" content="A Practical Approach to Temporal Architecture"/>
	<meta name="twitter:description" content="What it takes to get Temporal workflows up and running"/>
	<meta name="twitter:creator" content="@MikhailShilkov"></meta>
</head>
<body><script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load("current", {packages:["corechart"]});
    function addChart(make) {
        google.charts.setOnLoadCallback(drawChart);
        function drawChart() {
            const data = new google.visualization.DataTable();

            const options = {
                height: 420,  
                chartArea: { width: '85%', height: '70%' },
                legend: 'none',
                hAxis: { minValue: 0 },
                vAxis: {},
                series: {      
                    0: { tooltip : false}
                }
            };
            const chart = make(data, options);
            options.hAxis.textStyle = options.hAxis.titleTextStyle 
                = options.vAxis.textStyle = options.vAxis.titleTextStyle = { fontName: 'Merriweather' };

            chart.draw(data, options);
        }
    }
</script>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container pr-0">
        <a class="navbar-brand" href="/">
            <img class="author-thumb" src="/images/author.jpg" alt="Mikhail Shilkov">
            <span class="text-primary">Mikhail Shilkov</span>
        </a>

        
               


        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                
                <li class="nav-item ">
                    <a class="nav-link" href="/tags/">TOPICS</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/archives/">ARCHIVES</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/talks/">TALKS</a>
                </li>
                
                <li class="nav-item ">
                    <a class="nav-link" href="/about/">ABOUT</a>
                </li>
                <li class="nav-item">
    <a class="nav-link" href="https://mikhail.io/feed/"><i class="fas fa-rss social-icon" aria-hidden="true"></i></a>
</li>

<li class="nav-item">
    <a class="nav-link" href="https://x.com/MikhailShilkov"><i class="fab fa-twitter social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://dev.to/mikhailshilkov"><i class="fab fa-dev social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://medium.com/@MikhailShilkov"><i class="fab fa-medium social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://github.com/MikhailShilkov"><i class="fab fa-github social-icon" aria-hidden="true"></i></a>
</li>


<li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/MikhailShilkov"><i class="fab fa-linkedin social-icon" aria-hidden="true"></i></a>
</li>

</ul>
        </div>
        
    </div>
</nav>


        <div class="container">

<div class="main-content">
    
    <div class="container">
        <div class="row">
            
            <div class="col-lg-2 pl-0"><div class="share">
    <ul>
        <li class="ml-1 mr-1" title="Say 'Thank You' for this article">
            <a href="#" onclick="heart();return false;">
                <i class="fas fa-heart" style="color: red"></i>
            </a>
            <div class="count" style="float: right; padding-left: .5em; padding-top: .25em" id="heartcount"></div>
        </li>

        <li class="ml-1 mr-1" title="Tweet this article">
            <a target="_blank"
                href="https://x.com/intent/tweet?text=A%20Practical%20Approach%20to%20Temporal%20Architecture%20by%20@MikhailShilkov&url=https%3a%2f%2fmikhail.io%2f2020%2f10%2fpractical-approach-to-temporal-architecture%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1" title="See the responses or write a response">
            <a href="#comments">
                <i class="fas fa-comment"></i>
            </a>
        </li>
    </ul>
</div></div>
            
            <div class="col-lg-9 flex-first flex-lg-unordered">

                <div class="mainheading">
                    
                    <h1 class="posttitle">A Practical Approach to Temporal Architecture</h1>
                    
                    <div class="post-top-meta">
                        <div>
                            
                                
                                <span class="post-date">Published on Oct 22, 2020
                                
                            
                            
                        &nbsp;&middot;&nbsp; 4 min read</span></span>
                        </div>
                    </div>
                </div>
                
                
                

                
                <div class="article-post">
                    <p><a href="https://temporal.io">Temporal</a> enables developers to build highly reliable applications without having to worry about all the edge cases. If you are new to Temporal, check out my article <a href="https://mikhail.io/2020/10/temporal-open-source-workflows-as-code/">Open Source Workflows as Code</a>. Now that you&rsquo;re excited, I&rsquo;ll cover how you can get up and running with Temporal.</p>
<p>Temporal consists of several components. In this post, I want to outline the primary building blocks and their interactions. By the end, you&rsquo;ll have a broad picture of Temporal and the considerations of deploying to development, staging, and production environments.</p>
<h2 id="workers">Workers</h2>
<p>Workers are compute nodes that run your Temporal application code. You compile your workflows and activities into a worker executable. Next you can run the worker executable in the background and it will listen for new tasks to process.</p>
<p>Your first development environment will probably only need one worker that runs both workflows and activities in a single process. The worker can be hosted anywhere you wish: as a local process on your laptop, as an AWS Fargate task, as a pod in Kubernetes, and so on.</p>
<figure >
    
        <img src="worker.png"
            alt="A Temporal worker executes workflows and activities"
             />
        
    
    <figcaption>
        <h4>A Temporal worker executes workflows and activities</h4>
    </figcaption>
    
</figure>
<p>Production deployments typically run numerous workflows with significant load, so you will likely need to run multiple workers in parallel. Ensuring that nodes are spread out over a compute cluster enables resiliency and scalability.</p>
<figure >
    
        <img src="workers.png"
            alt="Workload scaled out to several Temporal workers"
             />
        
    
    <figcaption>
        <h4>Workload scaled out to several Temporal workers</h4>
    </figcaption>
    
</figure>
<p>Workers operate independently, each crunching through its share of the workload. Workers are logically &ldquo;stateless&rdquo;: they don&rsquo;t keep track of the past and future. Workers don&rsquo;t talk to each other directly, but they coordinate via a central Temporal service—the brain of the system.</p>
<h2 id="temporal-service">Temporal Service</h2>
<p>Temporal Service is a component provided by Temporal. Its purpose is to keep track of workflows, activities, and tasks and coordinate workers&rsquo; execution.</p>
<p>Your early environments may have a single Service instance running in the background. A worker knows the Service&rsquo;s domain name (IP) and port and connects to the Service via gRPC.</p>
<figure >
    
        <img src="service.png"
            alt="Worker interacting with Temporal Service"
             />
        
    
    <figcaption>
        <h4>Worker interacting with Temporal Service</h4>
    </figcaption>
    
</figure>
<p>Temporal Service itself consists of multiple components: a front-end, matching, history, and others. However, it&rsquo;s okay to treat it as a black-box &ldquo;Service&rdquo; for now.</p>
<p>Once you start growing your workloads, you will need to scale the Service components out to multiple instances for high resilience and throughput. So, several workers are now talking to several service instances.</p>
<figure >
    
        <img src="services.png"
            alt="Temporal Cluster running multiple components"
             />
        
    
    <figcaption>
        <h4>Temporal Cluster running multiple components</h4>
    </figcaption>
    
</figure>
<p>Temporal Service can tolerate node failures because it stores its state in an external storage.</p>
<h2 id="data-store">Data Store</h2>
<p>All the workflow data—task queues, execution state, activity logs—are stored in a persistent Data Store. Persistence technology is pluggable with two options currently officially supported: Cassandra and MySQL. More alternatives, including PostgreSQL, are on the way.</p>
<p>A MySQL database completes the simplest Temporal deployment diagram.</p>
<figure >
    
        <img src="mysql.png"
            alt="MySQL as a Data Store for Temporal"
             />
        
    
    <figcaption>
        <h4>MySQL as a Data Store for Temporal</h4>
    </figcaption>
    
</figure>
<p>For heavily distributed applications that experience high load, it may be better to use Cassandra instead. This database could be a cluster managed by yourself or a managed cloud service (like Azure Cosmos DB):</p>
<figure >
    
        <img src="cassandra.png"
            alt="Cassandra as a Data Store for Temporal"
             />
        
    
    <figcaption>
        <h4>Cassandra as a Data Store for Temporal</h4>
    </figcaption>
    
</figure>
<p>Your code never interacts with the Data Store directly. Basically, it&rsquo;s a (rather important) implementation detail of the Temporal Service.</p>
<h2 id="temporal-web-console">Temporal Web Console</h2>
<p>Temporal provides a handy web console to view namespaces, workflows, and activity history. Technically, it&rsquo;s not a required component—but you probably want to have it under your belt for manual inspection and troubleshooting.</p>
<p>You&rsquo;ll likely have other client components, for instance, to start workflow executions.</p>
<h2 id="external-client">External Client</h2>
<p>You need a client to start your very first workflow execution. It can be the Temporal command-line interface <code>tctl</code> or any custom code that you wrote with a call to initiate a workflow using an SDK or raw gRPC.</p>
<p>Each client must connect to a Temporal Service in order to start or terminate workflows, wait for completion, list the results from the history, and so on. For instance, a web application could start a workflow execution every time it handles a particular HTTP endpoint.</p>
<h2 id="put-it-all-together">Put It All Together</h2>
<p>The following picture puts all the pieces covered above together.</p>
</div>
</div>
</div>
<div class="row no-gutter">
    <div class="col-lg-1 pl-0"></div>
    <div class="col-sm-11">
        
<figure >
    
        <img src="components.png"
            alt="High-level Temporal architecture"
             />
        
    
    <figcaption>
        <h4>High-level Temporal architecture</h4>
    </figcaption>
    
</figure>

    </div>
</div>
<div class="row">
    <div class="col-lg-2 pl-0"></div>
    <div class="col-lg-9 flex-first flex-lg-unordered">
        <div class="article-post">
<p>As you can tell, there are quite a few components that go into making Temporal tick! Temporal is designed to handle millions of workflows reliably with high-performance guarantees while being open-source and portable across different infrastructure options. This dictates the usage of a multi-tier approach.</p>
<p>You can deploy everything to your development machine with the <a href="https://docs.temporal.io/docs/go-run-your-first-app/">getting started guide</a>. After that, you can start moving the components to your favorite cloud environment. Over the next weeks, I&rsquo;ll be working through automation scenarios and accompanying blog posts to help you manage typical deployment needs.</p>

                </div>

                
                <div class="after-post-tags">
                    <ul class="tags">
                        
                        <li>
                            
                            
                            <a href="/tags/temporal">Temporal</a>
                            
                        </li>
                        
                    </ul>
                </div>
                

                <hr/>

            </div>
            
        </div>
    </div>
    
    <div class="container">
    <div id="sharepane" class="row justify-content-center">
        <div class="col-md-2">

        </div>
        <div class="contact-intro col-md-2 text-center">
            <img class="profile-small d-inline-block mx-auto rounded-circle mb-3" height="100px"
                src="/images/author.jpg" alt="">
        </div>
        <div class="col-md-8">
            <section class="article-open_author">
                <div class="article-open_author_bio">
                    <h5 itemprop="author" itemscope="" itemtype="http://schema.org/Person">Author: Mikhail Shilkov</h5>
                    <p>
                        <div>Cloud and AI developer and researcher.</div><div>Principal engineer at Pulumi.</div>
                    </p>
                </div>
            </section>
            <a href="https://x.com/MikhailShilkov?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @MikhailShilkov</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
    </div>
</div>
<div class="container">
    <div id="comments" class="row justify-content-center mb-5">
        <div class="col-md-8">
            
            <div class="mb-5">
                <h5 class="float-left">Responses</h5>
                <div class="float-right"><a
                        href='https://github.com/mikhailshilkov/mikhailio-hugo/issues/46'>Write a
                        response</a></div>
            </div>
            <div id="gh-comments-list" style="display: none">46</div>
            <div class="mt-4">Visit the <b><a
                        href='https://github.com/mikhailshilkov/mikhailio-hugo/issues/46'>Github
                        Issue</a></b> to comment on this page</div>
            
        </div>
    </div>
</div>
</div>

        </div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright Mikhail Shilkov - All rights reserved
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                
            </div>
        </div>
    </div>
</footer>


<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('code.language-diff span span').forEach(function(span) {
        const text = span.textContent;
        if (text.startsWith('-')) {
            span.style.backgroundColor = '#ffdddd';
            span.style.color = '#d73a49';
            span.style.display = 'block';
        } else if (text.startsWith('+')) {
            span.style.backgroundColor = '#ddffdd';
            span.style.color = '#28a745';
            span.style.display = 'block';
        }
    });
});
</script>











<script src="/js/bundle.min.js"></script>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-NL7F82LX48"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NL7F82LX48');
        }
      </script>
    </body>
</html>
